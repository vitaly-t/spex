<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>spex API</title>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-spex.html">spex</a></li></ul><h3>Namespaces</h3><ul><li><a href="errors.html">errors</a></li><li><a href="stream.html">stream</a></li></ul><h3>Classes</h3><ul><li><a href="errors.BatchError.html">BatchError</a></li><li><a href="errors.PageError.html">PageError</a></li><li><a href="errors.SequenceError.html">SequenceError</a></li><li><a href="PromiseAdapter.html">PromiseAdapter</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-batch.html">Batch Processing</a></li><li><a href="tutorial-client.html">Client-Side Usage</a></li><li><a href="tutorial-mixed.html">Mixed Values</a></li><li><a href="tutorial-sequencing.html">Linked and Detached Sequencing</a></li><li><a href="tutorial-streaming.html">Streaming and Paging</a></li><li><a href="tutorial-throttling.html">Data Throttling & Load Balancing</a></li></ul><h3>Global</h3><ul><li><a href="global.html#batch">batch</a></li><li><a href="global.html#page">page</a></li><li><a href="global.html#sequence">sequence</a></li></ul>
    <div class="home-link">
        <a href="https://github.com/vitaly-t/spex">&lt;&lt; GitHub</a>
    </div>
</nav>

<div id="main">
    




<section>

<header>
    
        <h2>stream</h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><p>Namespace with methods that implement stream operations, and <a href="stream.html#.read">read</a> is the only method currently supported.</p>
<p><strong>Synchronous Stream Processing</strong></p>
<pre class="prettyprint source lang-js"><code>const stream = require('spex')(Promise).stream;
const fs = require('fs');

const rs = fs.createReadStream('values.txt');

function receiver(index, data, delay) {
   console.log('RECEIVED:', index, data, delay);
}

stream.read(rs, receiver)
    .then(data => {
        console.log('DATA:', data);
    })
    .catch(error => {
        console.log('ERROR:', error);
    });
</code></pre>
<p><strong>Asynchronous Stream Processing</strong></p>
<pre class="prettyprint source lang-js"><code>const stream = require('spex')(Promise).stream;
const fs = require('fs');

const rs = fs.createReadStream('values.txt');

function receiver(index, data, delay) {
   return new Promise(resolve => {
       console.log('RECEIVED:', index, data, delay);
       resolve();
   });
}

stream.read(rs, receiver)
    .then(data => {
        console.log('DATA:', data);
    })
    .catch(error => {
        console.log('ERROR:', error);
   });
</code></pre></div>
        

        


    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>stream.read</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Consumes and processes data from a <a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable</a> stream.</p></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="ext_stream_index.js.html">ext/stream/index.js</a>, <a href="ext_stream_index.js.html#line5">line 5</a>
    </li></ul></dd>
    

    

    

    
</dl>


        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id=".read"><span class="type-signature">(static) </span>read<span class="signature">(stream, receiver, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>
    

    



<div class="description">
    <p>Consumes and processes data from a <a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable</a> stream.</p>
<p>It reads the entire stream, using either <strong>paused mode</strong> (default), or in chunks (see <code>options.readChunks</code>)
with support for both synchronous and asynchronous data processing.</p>
<p><strong>NOTE:</strong> Once the method has finished, the onus is on the caller to release the stream
according to its protocol.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>stream</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p><a href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable</a> stream object.</p>
<p>Passing in anything else will throw <code>Readable stream is required.</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>receiver</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Data processing callback (or generator).</p>
<p>Passing in anything else will throw <code>Invalid stream receiver.</code></p>
<p>Parameters:</p>
<ul>
<li><code>index</code> = index of the call made to the function</li>
<li><code>data</code> = array of all data reads from the stream's buffer</li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>The function is called with the same <code>this</code> context as the calling method.</p>
<p>It can optionally return a promise object, if data processing is asynchronous.
And if a promise is returned, the method will not read data from the stream again,
until the promise has been resolved.</p>
<p>If the function throws an error or returns a rejected promise, the method rejects
with the same error / rejection reason.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional Parameters.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>closable</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>Instructs the method to resolve on event <code>close</code> supported by the stream, as opposed to event
<code>end</code> that's used by default.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>readChunks</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>By default, the method handles event <code>readable</code> of the stream to consume data in a simplified form,
item by item. If you enable this option, the method will instead handle event <code>data</code> of the stream,
to consume chunks of data.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>readSize</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>When the value is greater than 0, it sets the read size from the stream's buffer
when the next data is available. By default, the method uses as few reads as possible
to get all the data currently available in the buffer.</p>
<p>NOTE: This option is ignored when option <code>readChunks</code> is enabled.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="ext_stream_read.js.html">ext/stream/read.js</a>, <a href="ext_stream_read.js.html#line1">line 1</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>When finished successfully, resolves with object <code>{calls, reads, length, duration}</code>:</p>
<ul>
<li><code>calls</code> = number of calls made into the <code>receiver</code></li>
<li><code>reads</code> = number of successful reads from the stream</li>
<li><code>length</code> = total length for all the data reads from the stream</li>
<li><code>duration</code> = number of milliseconds consumed by the method</li>
</ul>
<p>When it fails, the method rejects with the error/reject specified,
which can happen as a result of:</p>
<ul>
<li>event <code>error</code> emitted by the stream</li>
<li>receiver throws an error or returns a rejected promise</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"></script>
</body>
</html>